<plex-layout>
    <plex-layout-main>
        <plex-box>
            <div class="row">
                <div class="col-2">
                    <app-foto-general (showFoto)="mostrarFoto($event)" [profesional]="profesional" [img64]="img64">
                    </app-foto-general>
                </div>
                <div class="col-9 margenFoto">
                    <app-header-profesional [profesional]="profesional"></app-header-profesional>
                </div>
                <div class="col-1 ">
                    <button class="float-right btn btn-primary" (click)="editar()">
                        <i class="mdi mdi-pencil"></i>
                    </button>
                </div>
            </div>
            <div id="wrapper">
                <plex-tabs *ngIf='profesional.habilitado'>
                    <plex-tab label="Contacto y Domicilios">
                        <app-contacto-domicilios-profesional [profesional]="profesional">
                        </app-contacto-domicilios-profesional>
                    </plex-tab>
                    <plex-tab label="Formación de Grado">
                        <app-formacion-grado [profesional]="profesional" (formacionGradoSelected)="formacionGradoSelected($event)"
                                             [tieneFirma]="tieneFirma" [tieneFirmaAdmin]="tieneFirmaAdmin"
                                             (updateProfesional)="guardarGrado($event)">
                        </app-formacion-grado>
                    </plex-tab>
                    <plex-tab label="Formación de Posgrado">
                        <div *ngIf=' habilitaPosgrado() !== undefined'>
                            <app-formacion-posgrado [profesional]="profesional" (formacionPosgradoSelected)="formacionPosgradoSelected($event,true)"
                                                    (updateProfesional)="updateProfesional($event)"></app-formacion-posgrado>
                        </div>
                        <div *ngIf=' habilitaPosgrado() === undefined'>
                            <span class="badge badge-danger">Su profesion no le permite cargar un posgrado</span>
                        </div>
                    </plex-tab>
                    <plex-tab label="Sanciones">
                        <app-sanciones [profesional]="profesional" (updateProfesional)="updateProfesional($event)">
                        </app-sanciones>
                    </plex-tab>
                    <plex-tab label="Foto">
                        <app-foto-profesional [profesional]="profesional" (onFileUploaded)="guardarFotoGrid($event)"
                                              (previewImg)="previewImg($event)"></app-foto-profesional>
                    </plex-tab>
                    <plex-tab label="Firmas">
                        <app-firmas-profesional [profesional]="profesional" (onFileUploaded)="guardarFirmaGrid($event)"
                                                (onFileUploadedFirmaAdmin)="guardarFirmaAdminGrid($event)" (tieneFirma)="this.tieneFirma = true"
                                                (tieneFirmaAdmin)="this.tieneFirmaAdmin = true">
                        </app-firmas-profesional>
                    </plex-tab>
                    <plex-tab label="Notas">
                        <app-notas-profesional [profesional]="profesional" (onSaved)="guardarNotas($event)">
                        </app-notas-profesional>
                    </plex-tab>
                    <plex-tab label="Otros">
                        <app-otros-datos [profesional]="profesional" (submitOtrosDatos)="guardarOtrosDatos($event)">
                        </app-otros-datos>
                    </plex-tab>
                </plex-tabs>
            </div>
            <div class="col-4" *ngIf="mostrar">
                <app-formacion-grado-detalle [formacion]="profesional.formacionGrado[indexFormacionGradoSelected]"
                                             [index]="indexFormacionGradoSelected" [profesional]="profesional"
                                             (cerrarDetalle)='cerrar(true)' (matriculacion)="matricularProfesional($event)"></app-formacion-grado-detalle>
            </div>
            <div class="col-4" *ngIf="mostrarGrado">
                <app-formacion-posgrado-detalle [formacion]="profesional.formacionPosgrado[indexFormacionPosgradoSelected]"
                                                [index]="indexFormacionPosgradoSelected" [profesional]="profesional"
                                                (matriculacion)="matricularProfesionalEspecialidad($event)"
                                                (anioDeGraciaOutPut)="anioDeGracia($event)" (cerrarDetalle)='cerrar(false)'>
                </app-formacion-posgrado-detalle>
            </div>
            <section *ngIf="!flag">
                <app-profesional [profesional]='profesional' [showOtraEntidadFormadora]='tieneOtraEntidad' [confirmar]='confirmar'
                                 (editado)="this.flag = true" [editable]='editable'></app-profesional>
            </section>
        </plex-box>
    </plex-layout-main>
    <plex-layout-footer>
        <plex-button type="danger" *ngIf="!flag" label="volver" (click)="volverProfesional()" icon="arrow-left-bold"
                     position="left"></plex-button>
        <plex-button type="danger" *ngIf="flag" label="volver" (click)="volver()" icon="arrow-left-bold" position="left">
        </plex-button>
    </plex-layout-footer>
</plex-layout>